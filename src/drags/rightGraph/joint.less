@baseBlue: #5ec1df;

.joint-paper {
  :global {
    .joint-viewport {
      user-select: none;
    }

    /* 节点矩形元素 */
    [magnet="true"]:not(.joint-element) {
      cursor: crosshair;
    }
    [magnet="true"]:not(.joint-element):hover {
      opacity: 0.7;
    }
    .joint-element {
      cursor: grab;
      &:active {
        cursor: grabbing;
      }
      // 最外层矩形
      .out-box {
        width: 164px;
        height: 96px;
        background-color: #fff;
        border: 1px solid #e0dbdb;
        border-radius: 5px;
        // box-shadow: 0px 4px #e0dbdb;
        // 直接在本元素加 box-shadow ，拖动时会重绘，严重掉帧卡顿，所以在 :after 上加
        &::after {
          content: "";
          position: absolute;
          z-index: -1;
          display: block;
          width: inherit;
          height: inherit;
          border-radius: inherit;
          box-shadow: 0px 4px #e0dbdb;
          transform: translateY(-65px) translateX(-1px);
        }
        &:hover {
          border-color: @baseBlue;
          .l-path,
          .l-path-left-top {
            fill: #2196f3;
            // display: block;
          }
        }
        // 矩形里的文字
        p {
          height: 64px;
          border-bottom: 1px solid #e7e8ed;
          display: flex;
          justify-content: center;
          align-items: center;
          font-family: PingFangSC-Regular;
          font-size: 14px;
          color: #666666;
          letter-spacing: 0;
          line-height: 22px;
          overflow: hidden;
          padding: 10px;
          &:before {
            content: " ";
            display: block;
            width: 20px;
            min-width: 20px;
            height: 20px;
            margin-right: 5px;
            background-size: 20px;
            background-repeat: no-repeat;
            background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjEgKDY3MDQ4KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT7mnI3liqE8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0i5pyN5YqhIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i5YiG57uELTctY29weSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgeD0iMCIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMS44NDUxMTQ5LDExLjc1MTcwNDIgTDEwLjM2NTk0MywxMC45NjQ0MDMgTDguOTEwNjI4NjUsMTEuNzc1NTYxOCBMOS4xNzMwNjIzOCwxMC4wODE2NzEzIEw3Ljk1NjMyNDE3LDguODg4NzkwNzUgTDkuNjAyNDk5NDEsOC42MjYzNTcwMiBMMTAuMzE4MjI3OCw3LjA3NTYxMjI0IEwxMS4wODE2NzEzLDguNjAyNDk5NDEgTDEyLjcyNzg0NjYsOC44NDEwNzU1MiBMMTEuNTU4ODIzNiwxMC4wNTc4MTM3IEwxMS44NDUxMTQ5LDExLjc1MTcwNDIgWiBNMTQuMjc4NTkxMyw1IEw2LjUyNDg2NzQ2LDUgQzYuMjE0NzE4NTEsNSA2LDUuMzM0MDA2NTcgNiw1LjY2ODAxMzEzIEw2LDE0LjM1MjE4MzkgQzYsMTUuMTg3MjAwMyA2Ljc4NzMwMTE5LDE1LjAyMDE5NyA3LjA3MzU5MjUzLDE0LjkwMDkwOSBMOS45MTI2NDgzNiwxMy42MTI1OTc5IEMxMC4xOTg5Mzk3LDEzLjQ5MzMwOTkgMTAuNjc2MDkxOSwxMy40Njk0NTIzIDEwLjk2MjM4MzMsMTMuNjEyNTk3OSBMMTMuOTkyMywxNC45NDg2MjQyIEMxNC4yNzg1OTEzLDE1LjA2NzkxMjIgMTQuOTIyNzQ2OSwxNS4wMjAxOTcgMTQuOTIyNzQ2OSwxNC4yODA2MTExIEwxNC45MjI3NDY5LDUuNjY4MDEzMTMgQzE0Ljg3NTAzMTcsNS4zMzQwMDY1NyAxNC41ODg3NDAzLDUgMTQuMjc4NTkxMyw1IFoiIGlkPSLlvaLnirYiIGZpbGw9IiNBMEFCQkYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==");
          }
        }
      }
      // 垃圾箱容器，因为垃圾桶中间的空白无法响应点击事件，所以把点击事件加到这里
      .rubbish-rect {
        width: 16px;
        height: 16px;
        x: 10px;
        y: 72px;
        fill: none;
        cursor: pointer;
        pointer-events: all; // 已经用了 fill: none；加这句很重要，否则 hover 不灵
        &:hover ~ .rubbish {
          opacity: 0.5;
        }
      }
      // 垃圾箱
      .rubbish {
        d: path(
          "M15.3333333,4.08333333 L12.75,4.08333333 L12,3.33333333 L8.33333333,3.33333333 L7.58333333,4.08333333 L5,4.08333333 L5,5.58333333 L15.25,5.58333333 L15.25,4.08333333 L15.3333333,4.08333333 Z M5.75,15.1666667 L5.75,6.33333333 L14.5833333,6.33333333 L14.5833333,15.1666667 C14.5833333,16 13.9166667,16.6666667 13.0833333,16.6666667 L7.25,16.6666667 C6.41666667,16.6666667 5.75,16 5.75,15.1666667 Z M8,8 L8,14 L9,14 L9,8 L8,8 Z M11,8 L11,14 L12,14 L12,8 L11,8 Z"
        );
        transform: translateX(5px) translateY(70px);
        opacity: 0.2;
        pointer-events: none;
      }
      // 矩形外面的四个 L 卡框
      .l-path {
        pointer-events: all;
        fill: transparent;
        d: path("M0,0 L15,0 L12,2 L2,2 L2,12 L0,15 Z");
      }
      .l-path-left-top {
        transform: translateX(-7px) translateY(-7px);
      }
      .l-path-right-top {
        transform: translateX(170px) translateY(-7px) rotate(90deg);
      }
      .l-path-left-buttom {
        transform: translateX(-7px) translateY(104px) rotate(-90deg);
      }
      .l-path-right-buttom {
        transform: translateX(170px) translateY(104px) rotate(180deg);
      }
    }
    // 拖拽节点的特效
    .cell-dragging {
      .out-box {
        background-color: #d7eff6;
        p {
          border-bottom: 1px solid @baseBlue;
        }
        &::after {
          display: none;
        }
      }
      .l-path {
        fill: #2196f3;
      }
    }

    /* svg 缩放时的中心点 */
    .joint-viewport {
      transform-origin: center;
    }

    /* 节点的锚点和删除按钮 */
    // 一开始不显示链接端口
    .joint-port-body {
      fill: none;
      pointer-events: all; // 已经用了 fill: none；加这句很重要，否则 hover 不灵
      stroke-width: 0;
      r: 0.5px;
    }
    .joint-element:hover {
      // hover 到节点上显示 端口,半径变大，线宽 2

      .joint-port-body {
        stroke: @baseBlue;
        stroke-width: 2;
        r: 5px;
      }
      // hover 到端口上,半径变小，线宽 12，这样才能增加选中区域面积

      .joint-port-body:hover {
        stroke-width: 12;
        stroke-opacity: 1;
        opacity: 1;
        r: 0.5px;
      }
    }
    // 删除按钮组件
    .delete-button,
    .delete-cancle-button,
    .delete-button-text,
    .delete-cancle-button-text {
      display: none;
      font-size: 12px;
      letter-spacing: 0;
      cursor: pointer;
    }
    .delete-cell-show {
      .delete-button {
        display: block;
        cy: 89px;
        cx: -21px;
        r: 15px;
        fill: #ef5350;
        stroke: #f80c0c;
        stroke-width: 0.5px;
      }
      .delete-cancle-button {
        display: block;
        cy: 120px;
        cx: 11px;
        r: 15px;
        fill: #f7f8fa;
        stroke: #d9d1d1;
        stroke-width: 0.7px;
      }
      .delete-button-text {
        display: block;
        transform: translateX(-33px) translateY(94px);
        fill: #ffffff;
        pointer-events: none;
      }
      .delete-cancle-button-text {
        display: block;
        transform: translateX(-1px) translateY(125px);
        fill: #76889c;
        pointer-events: none;
      }
      .rubbish {
        fill: #198bf4;
        opacity: 1;
      }
    }

    /* 连接线 外层的一层遮罩，hover 上去显现 */
    .joint-link {
      .marker-arrowheads {
        display: none;
      }
      .marker-vertices {
        cursor: move;
        opacity: 0;
      }

      .link-tools {
        opacity: 0;
        cursor: pointer;
        .tool-options {
          display: none;
        }
      }
      &:hover {
        .link-tools,
        .marker-vertices {
          opacity: 1;
        }
      }

      .connection {
        fill: none;
      }

      .connection-wrap {
        fill: none;
        stroke: #000000;
        stroke-width: 7;
        stroke-linecap: round;
        stroke-linejoin: round;
        opacity: 0;
        &:hover {
          opacity: 0.3;
          stroke-opacity: 0.3;
        }
      }

      .link-tools .tool-remove {
        circle {
          fill: #f05c2b;
          r: 6;
        }
        path {
          fill: #fff;
          d: path(
            "M -3.5 0.7, -3.5 -0.7, -0.7 -0.7, -0.7 -3.5, 0.7 -3.5, 0.7 -0.7 ,3.5 -0.7, 3.5 0.7, 0.7 0.7, 0.7 3.5, -0.7 3.5,-0.7 0.7 z"
          );
          transform: rotate(45deg) scale(1.5);
        }
      }
    }
  }
}
